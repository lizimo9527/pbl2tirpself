{"code":"import { __awaiter } from \"tslib\";\nimport { defineComponent } from \"vue\";\nimport { getUserPlans, deleteTravelPlan, publishPlan } from '../../services/travelService.js';\nexport default defineComponent({\n    data() {\n        return {\n            plans: [],\n            activeFilter: 'all',\n            userId: 'demo-user-123' // 实际项目中应该从用户信息获取\n        };\n    },\n    computed: {\n        filteredPlans() {\n            if (this.activeFilter === 'all') {\n                return this.plans;\n            }\n            return this.plans.filter((plan = null) => { return plan.status === this.activeFilter; });\n        }\n    },\n    methods: {\n        getStatusText(status = null) {\n            const statusMap = new UTSJSONObject({\n                draft: '草稿',\n                published: '已发布',\n                completed: '已完成'\n            });\n            return statusMap[status] || status;\n        },\n        formatDates(startDate = null, endDate = null) {\n            if (!startDate)\n                return '未设置日期';\n            const start = new Date(startDate).toLocaleDateString();\n            if (!endDate)\n                return start;\n            const end = new Date(endDate).toLocaleDateString();\n            return `${start} - ${end}`;\n        },\n        viewPlanDetail(plan = null) {\n            uni.navigateTo(new UTSJSONObject({\n                url: `/pages/guide/guide-enhanced?id=${plan.id}`\n            }));\n        },\n        editPlan(plan = null) {\n            uni.navigateTo(new UTSJSONObject({\n                url: `/pages/plan/edit/edit?id=${plan.id}`\n            }));\n        },\n        deletePlan(plan = null) {\n            return __awaiter(this, void 0, void 0, function* () {\n                uni.showModal(new UTSJSONObject({\n                    title: '确认删除',\n                    content: `确定要删除攻略\"${plan.title}\"吗？此操作不可恢复。`,\n                    success: (res = null) => { return __awaiter(this, void 0, void 0, function* () {\n                        if (res.confirm) {\n                            try {\n                                yield deleteTravelPlan(plan.id);\n                                yield this.loadPlans();\n                                uni.showToast(new UTSJSONObject({ title: '删除成功', icon: 'success' }));\n                            }\n                            catch (error) {\n                                uni.showToast(new UTSJSONObject({ title: '删除失败', icon: 'none' }));\n                            }\n                        }\n                    }); }\n                }));\n            });\n        },\n        publishPlan(plan = null) {\n            return __awaiter(this, void 0, void 0, function* () {\n                uni.showModal(new UTSJSONObject({\n                    title: '发布攻略',\n                    content: '确定要发布这个攻略吗？发布后其他人可以看到。',\n                    success: (res = null) => { return __awaiter(this, void 0, void 0, function* () {\n                        if (res.confirm) {\n                            try {\n                                yield publishPlan(plan.id);\n                                yield this.loadPlans();\n                                uni.showToast(new UTSJSONObject({ title: '发布成功', icon: 'success' }));\n                            }\n                            catch (error) {\n                                uni.showToast(new UTSJSONObject({ title: '发布失败', icon: 'none' }));\n                            }\n                        }\n                    }); }\n                }));\n            });\n        },\n        createNewPlan() {\n            uni.switchTab(new UTSJSONObject({\n                url: '/pages/create/create'\n            }));\n        },\n        loadPlans() {\n            return __awaiter(this, void 0, void 0, function* () {\n                uni.showLoading(new UTSJSONObject({ title: '加载中...' }));\n                try {\n                    this.plans = yield getUserPlans(this.userId);\n                }\n                catch (error) {\n                    uni.showToast(new UTSJSONObject({ title: '加载失败', icon: 'none' }));\n                }\n                uni.hideLoading();\n            });\n        }\n    },\n    onLoad() {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.loadPlans();\n        });\n    },\n    onPullDownRefresh() {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.loadPlans();\n            uni.stopPullDownRefresh();\n        });\n    }\n});\n//# sourceMappingURL=E:/pbl2/tripself/pages/my-plans/my-plans.uvue?vue&type=script&lang.uts.js.map","references":["E:/pbl2/tripself/services/travelService.js"],"uniExtApis":["uni.navigateTo","uni.showToast","uni.showModal","uni.switchTab","uni.showLoading","uni.hideLoading","uni.stopPullDownRefresh"],"map":"{\"version\":3,\"file\":\"my-plans.uvue?vue&type=script&lang.uts.js\",\"sourceRoot\":\"\",\"sources\":[\"my-plans.uvue?vue&type=script&lang.uts\"],\"names\":[],\"mappings\":\"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\"}"}
