<!--pages/plan/edit/edit.wxml-->
<view class="plan-container">
	<!-- é¡¶éƒ¨æ ‡é¢˜æ  -->
	<view class="header">
		<text class="title">æ—…è¡Œè§„åˆ’</text>
		<text class="subtitle">åœ¨åœ°å›¾ä¸Šè§„åˆ’æ‚¨çš„å®Œç¾è¡Œç¨‹</text>
	</view>

	<!-- æ—¥æœŸåˆ‡æ¢æ¨¡å— -->
	<view class="date-tabs">
		<scroll-view class="date-scroll" scroll-x="true">
			<view 
				wx:for="{{dates}}" 
				wx:key="index"
				class="date-tab {{currentDateIndex === index ? 'active' : ''}}"
				bindtap="switchDate"
				data-index="{{index}}"
			>
				<text class="date-text">{{item.name}}</text>
				<text class="date-desc">{{item.desc}}</text>
			</view>
		</scroll-view>
	</view>

	<!-- åœ°å›¾å±•ç¤ºæ¨¡å— -->
	<view class="map-section">
		<view class="map-header">
			<text class="section-title">åœ°å›¾å±•ç¤º</text>
			<view class="map-controls">
				<button class="control-btn" bindtap="zoomIn">+</button>
				<button class="control-btn" bindtap="zoomOut">-</button>
			</view>
		</view>
		<view class="map-placeholder">
			<text class="map-icon">ğŸ—ºï¸</text>
			<text class="map-text">åœ°å›¾ç»„ä»¶</text>
			<text class="map-desc">æ”¯æŒç¼©æ”¾ã€æ‹–åŠ¨ã€æ ‡è®°ç‚¹æ“ä½œ</text>
			</view>
	</view>

	<!-- åœ°ç‚¹åˆ—è¡¨æ¨¡å— -->
	<view class="locations-section">
		<view class="section-header">
			<text class="section-title">å½“æ—¥è¡Œç¨‹</text>
			<button class="add-btn" bindtap="showSearchModal">+ æ·»åŠ åœ°ç‚¹</button>
		</view>
		<view class="locations-list">
			<view 
				wx:for="{{locations[currentDateIndex]}}" 
				wx:key="index"
				class="location-item"
				bindtap="focusOnLocation"
				data-index="{{index}}"
			>
				<view class="location-info">
					<text class="location-name">{{item.name}}</text>
					<text class="location-details">{{item.transport}} Â· {{item.distance}} Â· {{item.duration}}</text>
				</view>
				<view class="location-actions">
					<button class="action-btn edit-btn" bindtap="editLocation" data-index="{{index}}">ç¼–è¾‘</button>
					<button class="action-btn delete-btn" bindtap="deleteLocation" data-index="{{index}}">åˆ é™¤</button>
				</view>
			</view>
		</view>
	</view>

	<!-- è·¯çº¿è§„åˆ’æ¨¡å— -->
	<view class="route-section">
		<view class="section-header">
			<text class="section-title">è·¯çº¿è§„åˆ’</text>
			<button class="route-btn" bindtap="generateRoute">æ™ºèƒ½è·¯çº¿è§„åˆ’</button>
		</view>
		<view class="route-info">
			<text class="route-total">æ€»è¡Œç¨‹ï¼š{{routeInfo.totalDistance}} Â· {{routeInfo.totalDuration}}</text>
			<view class="route-segments">
				<view 
					wx:for="{{routeInfo.segments}}" 
					wx:key="index"
					class="route-segment"
				>
					<text class="segment-info">{{item.distance}} {{item.duration}}</text>
				</view>
			</view>
		</view>
	</view>

	<!-- æœç´¢æ¨¡æ€æ¡† -->
	<view class="modal" wx:if="{{showSearch}}">
		<view class="modal-content">
			<view class="modal-header">
				<text class="modal-title">æœç´¢åœ°ç‚¹</text>
				<button class="close-btn" bindtap="hideSearchModal">Ã—</button>
			</view>
			<view class="search-input">
				<input 
					value="{{searchKeyword}}" 
					placeholder="è¾“å…¥æ™¯ç‚¹ã€ä½å®¿ã€äº¤é€šæ¢çº½ç­‰å…³é”®è¯"
					class="search-field"
					bindinput="onSearchInput"
				/>
				<button class="search-btn" bindtap="searchLocations">æœç´¢</button>
			</view>
			<view class="search-results">
				<view 
					wx:for="{{searchResults}}" 
					wx:key="index"
					class="search-result"
					bindtap="addLocationFromSearch"
					data-index="{{index}}"
				>
					<text class="result-name">{{item.name}}</text>
					<text class="result-type">{{item.type}}</text>
				</view>
			</view>
		</view>
	</view>

	<!-- å¤‡æ³¨ç¼–è¾‘æ¨¡æ€æ¡† -->
	<view class="modal" wx:if="{{showNoteModal}}">
		<view class="modal-content">
			<view class="modal-header">
				<text class="modal-title">æ·»åŠ å¤‡æ³¨</text>
				<button class="close-btn" bindtap="hideNoteModal">Ã—</button>
			</view>
			<view class="note-input">
				<textarea 
					value="{{currentNote}}" 
					placeholder="è¾“å…¥å¯¹è¯¥åœ°ç‚¹çš„è¡Œç¨‹å®‰æ’ã€ç‰¹è‰²è¯´æ˜ç­‰å¤‡æ³¨ä¿¡æ¯"
					class="note-field"
					maxlength="200"
					bindinput="onNoteInput"
				></textarea>
				<text class="note-count">{{currentNote.length}}/200</text>
			</view>
			<view class="modal-actions">
				<button class="cancel-btn" bindtap="hideNoteModal">å–æ¶ˆ</button>
				<button class="confirm-btn" bindtap="saveNote">ä¿å­˜</button>
			</view>
		</view>
	</view>
</view>