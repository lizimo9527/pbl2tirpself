# TripSelf 微信小程序部署指南

## 🚀 快速开始

### 1. 配置微信小程序AppID
在 `manifest.json` 文件中已经配置了微信小程序AppID：
```json
"mp-weixin": {
    "appid": "wx01ec39d13007f16b"
}
```

### 2. 在HBuilderX中运行微信小程序
1. 打开HBuilderX
2. 选择项目根目录
3. 点击顶部菜单：运行 → 运行到小程序模拟器 → 微信开发者工具
4. 等待编译完成，微信开发者工具会自动打开

### 3. 微信小程序预览和上传
1. 在微信开发者工具中预览效果
2. 点击"上传"按钮上传代码
3. 在微信公众平台提交审核

## 📱 微信小程序适配特性

### ✅ 已完成的适配
- **样式统一**：网页端和小程序端使用相同的视觉设计
- **响应式布局**：适配不同屏幕尺寸
- **功能完整**：所有核心功能都已适配
- **性能优化**：针对小程序平台进行了优化

### 🎨 设计特色
- **渐变背景**：紫蓝色渐变 (#667eea → #764ba2)
- **卡片式布局**：现代化UI设计
- **圆角设计**：友好的视觉体验
- **阴影效果**：增强层次感

## 🔧 开发命令

```bash
# 开发微信小程序
npm run dev:mp-weixin

# 打包微信小程序
npm run build:mp-weixin
```

## 📋 页面功能

### 首页 (/pages/index/index)
- 搜索功能
- 快捷功能网格（8个功能模块）
- 热门推荐横向滚动
- 今日推荐大卡片
- 下拉刷新功能

### 地图页面 (/pages/map/map)  
- 地图显示
- 定位功能
- 附近搜索

### 个人中心 (/pages/user/user)
- 用户信息展示
- 功能菜单

## ⚡ 性能优化

### 微信小程序特有优化
- **分包加载**：支持代码分包，提升加载速度
- **懒加载**：图片和组件按需加载
- **缓存策略**：合理使用小程序缓存
- **网络优化**：减少不必要的网络请求

### 样式优化
- **rpx单位**：完美适配不同屏幕
- **CSS压缩**：减少样式文件大小
- **图片优化**：使用合适的图片格式和尺寸

## 🛠️ 技术栈

- **框架**：uni-app (Vue 3)
- **样式**：SCSS + rpx单位
- **构建工具**：Vite
- **小程序平台**：微信小程序

## 🛠️ 常见问题解决

### WXSS 编译错误
如果遇到类似 `unexpected character` 的编译错误：
- 检查样式文件中是否包含中文字符作为CSS类名
- 已修复：`guide-enhanced.uvue` 中的中文CSS类名问题

### Socket 域名校验错误
开发环境中的 WebSocket 连接错误解决方案：
1. **开发工具设置**：在微信开发者工具中勾选"不校验合法域名"
2. **项目配置**：`manifest.json` 中已设置 `"urlCheck": false`
3. **网络设置**：确保电脑和手机在同一网络环境

### WebSocket 连接失败
- 这是开发环境的正常现象，不影响功能
- 生产环境中会自动使用配置的合法域名
- 可以忽略 `socket 合法域名校验出错` 的警告

### 页面路由错误
如果遇到 `page "pages/guide/guide" is not found` 错误：
- **问题**：代码中使用了错误的页面路径 `pages/guide/guide`
- **解决**：已修复为正确的路径 `pages/guide/guide-enhanced`
- **影响文件**：`my-plans.uvue` 和 `templates.uvue` 中的页面跳转路径

### 图片资源加载失败
如果遇到 `Failed to load local image resource` 错误：
- **问题**：`static/images/templates/` 目录和图片文件缺失
- **解决**：已创建缺失的图片目录和文件
- **创建的文件**：
  - `static/images/templates/` 目录下的所有模板图片
  - `static/images/map/marker.png` 地图标记图片
  - `static/images/default-avatar.png` 默认头像图片

### Tabbar 页面跳转错误
如果遇到 `can not navigateTo a tabbar page` 错误：
- **问题**：使用 `uni.navigateTo` 跳转到 tabbar 页面
- **解决**：已修复为使用 `uni.switchTab` 跳转到 tabbar 页面
- **影响文件**：
  - `my-plans.uvue` - 创建新攻略跳转
  - `templates.uvue` - 使用模板跳转
  - `guide.uvue` - 编辑攻略跳转
- **注意**：`switchTab` 不支持参数传递，如需传递数据请使用其他方式

### 攻略模板功能优化
已优化攻略模板的使用体验：
- **新增页面**：创建了专门的模板详情页面 `pages/template-detail/template-detail`
- **功能改进**：点击模板跳转到专门的模板详情页面查看完整攻略
- **内容增强**：根据模板类型生成详细的行程安排和实用建议
- **支持类型**：文化探索式、自然探索式、美食探索式、特种兵式等
- **包含内容**：地图路线、详细行程、预算信息、实用提示、特色亮点等
- **页面特色**：每个模板都有专门的详情界面，展示该模板的独特之处

## 📞 技术支持

如果遇到问题，请检查：

1. **微信开发者工具版本**：确保使用最新版本
2. **HBuilderX版本**：更新到最新版本
3. **依赖包**：运行 `npm install` 确保依赖完整
4. **AppID配置**：确认微信小程序AppID正确配置
5. **开发工具设置**：勾选"不校验合法域名"选项

## 🎯 下一步

1. 在微信开发者工具中预览效果
2. 测试所有功能是否正常
3. 上传代码到微信公众平台
4. 提交审核发布

---

**祝您部署顺利！** 🎉